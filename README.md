# Clarity Bitcoin Client

Clarity Bitcoin Client is an open-source TypeScript library for interacting with the **Clarity-Bitcoin contract** on the Stacks blockchain. It provides utilities for constructing, verifying, and submitting Bitcoin transaction proofs to Clarity smart contracts.

## Features

- 📌 **Generate Merkle Proofs** for Bitcoin transactions
- 📌 **Verify SegWit & Non-SegWit Transactions**
- 📌 **Extract & Format Witness Data**
- 📌 **Minimal Dependencies** (`@stacks/transactions`, `@scure/btc-signer`)
- 📌 **Built for Stacks Developers**

## Installation

```sh
npm install clarity-bitcoin-client
```

## Usage

### **1️⃣ Import the Library**

```typescript
import { generateProof, verifyTxMined } from "clarity-bitcoin-client";
```

### **2️⃣ Generate a Proof for a Bitcoin Transaction**

```typescript
const proof = await generateProof({
  blockHeight: 781423,
  txIndex: 2,
  rawTx: "...", // Bitcoin transaction hex
  blockHeader: "...",
  merkleProof: ["...", "..."],
});
```

### **3️⃣ Verify the Transaction Proof in Clarity**

```typescript
const isMined = await verifyTxMined(proof);
console.log("Transaction Verified:", isMined);
```

## API Reference

### `generateProof(options: ProofOptions): Promise<TxProof>`

Generates a **Merkle proof** for a Bitcoin transaction.

- **Options:**
  - `blockHeight: number` – The block height of the Bitcoin transaction
  - `txIndex: number` – The transaction index in the block
  - `rawTx: string` – The raw Bitcoin transaction hex
  - `blockHeader: string` – The Bitcoin block header hex
  - `merkleProof: string[]` – The Merkle proof hashes

### `verifyTxMined(proof: TxProof): Promise<boolean>`

Verifies if a Bitcoin transaction has been **mined** by submitting the proof to a Clarity contract.

- **Parameters:** `TxProof` – Proof data generated by `generateProof`
- **Returns:** `boolean` – `true` if mined, `false` otherwise

## Development

Clone the repository and install dependencies:

```sh
git clone https://github.com/your-repo/clarity-bitcoin-client.git
cd clarity-bitcoin-client
npm install
```

### **Build & Test**

```sh
npm run build  # Compile to dist/
npm test       # Run tests
```

### **Publishing to NPM**

```sh
npm run build
npm publish
```

## License

MIT

## Contributors

Open to contributions! Feel free to submit a PR. 🚀
